@startuml
skinparam noteTextAlignment center
skinparam sequenceMessageAlign direction
autonumber

title "DAIGO Protocol - Functional example"

participant "Client 1" as c1
participant "Server" as s
participant "Client 2" as c2

== Join the server ==

note over c1, c2
The socket is instanciated and the connection is
automatically established.
end note

c1 -> s : Establish Connection
c1 <--> s : Connection Established
c1 -> s : HELO alice
s -> c1 : OK

c2 -> s : Establish Connection
c2 <--> s : Connection Established
c2 -> s : HELO bob
s -> c2 : OK

== Create a Game ==
c1 -> s : CREATE
s -> c1 : OK

c1 -> s : PLAY
s -> c1 : WAIT

== Join a Game ==
c2 -> s : LIST
s -> c2 : GAMES alice

c2 -> s : JOIN alice
s -> c2 : OK

== Start playing ==

note over c1, c2
When a game is full, the server randomly chooses a player to start.
end note

c2 -> s : PLAY
s -> c2 : WAIT alice

c1 -> s : PLAY
s -> c1 : START bob

c1 -> s : STONE 2 2
s -> c1 : OK

c2 -> s : PLAY
s -> c2 : STONE 2 2

c2 -> s : STONE 2 3
s -> c2 : OK

== Quit ==

note over c1, c2
To quit, the client simply disconnects.
The socket is closed and the game state updated.
end note

c1 -> c1 : Close the connection
c1 <--> s : The connection is closed

s -> s : Game state updated

c2 -> s : PLAY
s -> c2 : DISCONNECT

c2 -> c2 : Close the connection
c2 <--> s : The connection is closed

@enduml
